const MILLENNIUM_IS_CLIENT_MODULE=!1,pluginName="battlepass-steam";function InitializePlugins(){var n,t;let e;(n=window.PLUGIN_LIST||(window.PLUGIN_LIST={}))[pluginName]||(n[pluginName]={}),(t=window.MILLENNIUM_PLUGIN_SETTINGS_STORE||(window.MILLENNIUM_PLUGIN_SETTINGS_STORE={}))[pluginName]||(t[pluginName]={}),window.MILLENNIUM_SIDEBAR_NAVIGATION_PANELS||(window.MILLENNIUM_SIDEBAR_NAVIGATION_PANELS={}),function(n){n[n.CallServerMethod=0]="CallServerMethod"}(e||(e={}));let o=window.MILLENNIUM_PLUGIN_SETTINGS_STORE[pluginName],r=`Millennium.Internal.IPC.[${pluginName}]`;const a={DropDown:["string","number","boolean"],NumberTextInput:["number"],StringTextInput:["string"],FloatTextInput:["number"],CheckBox:["boolean"],NumberSlider:["number"],FloatSlider:["number"]};o.ignoreProxyFlag=!1;const i=n=>new Proxy(n,{set(n,t,e){if(!(t in n))throw new TypeError(`Property ${String(t)} does not exist on plugin settings`);const i=a[n[t].type],c=n[t]?.range;if(i.includes("number")&&"number"==typeof e&&(c&&(e=function(n,t,e){return Math.max(t,Math.min(e,n))}(e,c[0],c[1])),e||(e=0)),!i.includes(typeof e))throw new TypeError(`Expected ${i.join(" or ")}, got ${typeof e}`);return n[t].value=e,((n,t)=>{o.ignoreProxyFlag||SteamClient.BrowserView.PostMessageToParent(r,JSON.stringify({name:n,value:t}))})(String(t),e),!0},get:(n,t)=>"__raw_get_internals__"===t?n:t in n?n[t].value:void 0});o.DefinePluginSetting=i,o.settingsStore=i({})}InitializePlugins();const __call_server_method__=(n,t)=>Millennium.callServerMethod(pluginName,n,t);function __wrapped_callable__(n){return n.startsWith("webkit:")?MILLENNIUM_API.callable((n,t)=>MILLENNIUM_API.__INTERNAL_CALL_WEBKIT_METHOD__(pluginName,n,t),n.replace(/^webkit:/,"")):MILLENNIUM_API.callable(__call_server_method__,n)}let PluginEntryPointMain=function(){return function(n){"use strict";const t={token:null,user:null,steamLogin:null,steamId64:null,paymentMethods:[],selectedMethod:null,currentCommission:null,promocode:"HELLO",promocodeDiscount:0,promocodeValid:!1,currency:"RUB",steamCurrency:null,convertedAmount:null},e=window.location.href.includes("checkout.steampowered.com");function o(n,t=!1){console.log(`[BattlePass] ${n}`);let e=document.getElementById("bp-debug-panel");e||(e=document.createElement("div"),e.id="bp-debug-panel",e.style.cssText="\n      position: fixed;\n      bottom: 10px;\n      left: 10px;\n      width: 400px;\n      max-height: 200px;\n      overflow-y: auto;\n      background: rgba(0,0,0,0.9);\n      color: #0f0;\n      font-family: monospace;\n      font-size: 11px;\n      padding: 10px;\n      border-radius: 8px;\n      z-index: 9999999;\n      border: 1px solid #333;\n    ",document.body.appendChild(e));const o=document.createElement("div");o.style.color=t?"#f44":"#0f0",o.textContent=`[${(new Date).toLocaleTimeString()}] ${n}`,e.appendChild(o),e.scrollTop=e.scrollHeight}async function r(n,t={}){o(`Backend: ${n}(${JSON.stringify(t).substring(0,50)})`);try{const e=await __call_server_method__(n,t),r=JSON.parse(e);if(r.error)throw o(`Backend error: ${r.error}`,!0),new Error(r.error);return o(`Backend success: ${JSON.stringify(r).substring(0,50)}...`),r}catch(n){throw o(`Backend call failed: ${n.message}`,!0),n}}function a(){void 0!==window.g_steamID&&window.g_steamID&&(t.steamId64=window.g_steamID);const n=document.querySelector("[data-miniprofile]");if(n){const e=n.getAttribute("data-miniprofile");e&&(t.steamId64=(BigInt("76561197960265728")+BigInt(e)).toString())}const e=window.location.href.match(/steamcommunity\.com\/(?:id|profiles)\/([^\/]+)/);if(e){const n=e[1];/^\d{17}$/.test(n)&&(t.steamId64=n)}document.querySelectorAll("script").forEach(n=>{const e=n.textContent?.match(/g_steamID\s*=\s*"(\d{17})"/);e&&(t.steamId64=e[1])});const o=document.querySelector(".account_name");if(o&&(t.steamLogin=o.textContent?.trim()||null),!t.steamLogin){const n=document.querySelector('a[href*="/account/"]');if(n){const e=(n.textContent?.trim()||"").match(/:\s*(.+)$/);e&&(t.steamLogin=e[1].trim())}}if(!t.steamLogin){const n=document.querySelector("#account_pulldown, .persona_name, .playerAvatar + a");n&&(t.steamLogin=n.textContent?.trim()||null)}return console.log("[BattlePass] Steam info:",{steamId64:t.steamId64,steamLogin:t.steamLogin}),{steamId64:t.steamId64,steamLogin:t.steamLogin}}async function i(){t.steamId64||a(),t.steamId64||(t.steamId64="76561198000000000");try{const n=await r("auth_steam",{steam_id64:t.steamId64,username:t.steamLogin||""});return t.token=n.access_token,t.user=n.user,o(`Auth success: ${t.token?.substring(0,20)}...`),n}catch(n){throw o(`Auth error: ${n}`,!0),n}}async function c(){t.token||await i();try{return t.paymentMethods=await r("get_payment_methods",{}),o(`Got ${t.paymentMethods.length} payment methods`),t.paymentMethods}catch(n){throw o(`Fetch methods error: ${n}`,!0),n}}async function s(n){if(!n||""===n.trim())return t.promocodeDiscount=0,t.promocodeValid=!1,t.promocode="",{valid:!1,discount:0};const e=n.toUpperCase();if(!t.token)try{await i()}catch(n){return t.promocodeDiscount=0,t.promocodeValid=!1,{valid:!1,discount:0}}try{const n=await r("validate_promocode",{code:e,account:t.steamLogin||"test"}),a=n.discount||n.percent||0;return t.promocodeDiscount=a,t.promocodeValid=a>0,t.promocode=e,o(`Promocode validated: ${e} = ${a}%`),{valid:t.promocodeValid,discount:a}}catch(n){return o(`Promocode validation error: ${n}`,!0),t.promocodeDiscount=0,t.promocodeValid=!1,{valid:!1,discount:0}}}async function l(n,e,a){if(t.token||await i(),e===a)return{amount:n,rate:1};try{const i=await r("convert_currency",{amount:parseInt(String(n)),from_currency:e,to_currency:a,account:t.steamLogin||"test"});return o(`Convert: ${n} ${e} -> ${i.input||i.amount} ${a}`),t.convertedAmount=i.input||i.amount,i}catch(n){throw o(`Convert error: ${n}`,!0),n}}function d(n){const e=document.getElementById("methods-grid");if(!e)return;if(!n||0===n.length)return void(e.innerHTML='<div class="loading-methods">–°–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã</div>');e.innerHTML=n.map((n,t)=>`\n    <button class="method-btn ${0===t?"active":""}" data-method="${n.name}" data-commission="${n.commission}" data-min="${n.min}">\n      <span class="method-text">\n        <span class="method-name">${n.display_name.replace(/–û—Ç \d+\.?\d* —Ä—É–±–ª–µ–π?/,"")}</span>\n        <span class="method-commission">${n.commission}%</span>\n      </span>\n    </button>\n  `).join(""),n.length>0&&(t.selectedMethod=n[0]),e.querySelectorAll(".method-btn").forEach(o=>{o.addEventListener("click",function(){e.querySelectorAll(".method-btn").forEach(n=>n.classList.remove("active")),this.classList.add("active");const o=this.dataset.method;t.selectedMethod=n.find(n=>n.name===o),p()})});const o=document.getElementById("custom-amount")?.value;o&&parseInt(o)>0&&p()}function m(n){const t=document.querySelector(".balance-info");if(!t)return;let e=t.querySelector(".balance-spinner"),o=t.querySelector(".balance-content");if(!o){const n=t.querySelectorAll(".info-row");o=document.createElement("div"),o.className="balance-content",n.forEach(n=>o.appendChild(n)),t.appendChild(o)}e||(e=document.createElement("div"),e.className="balance-spinner",e.innerHTML='<div class="spinner-circle"></div><span>–†–∞—Å—á—ë—Ç...</span>',t.insertBefore(e,o)),e.style.display=n?"flex":"none"}window.location.href.includes("store.steampowered.com/cart"),window.location.href.includes("store.steampowered.com/app/"),window.location.href.includes("store.steampowered.com/bundle/"),window.location.href.includes("store.steampowered.com/steamaccount/addfunds");let u=null;function p(){u&&clearTimeout(u),u=window.setTimeout(()=>{const n=document.getElementById("custom-amount")?.value||"0";document.getElementById("steam-login-input")?.value?.trim(),async function(n){const{amount:e,currency:a,methodName:c,promocode:s,promocodeDiscount:d}=n,u=parseInt(String(e))||0,p=document.getElementById("convert-row"),b=document.getElementById("convert-info"),h=c||t.selectedMethod?.name;if(!h||!t.selectedMethod)return null;if(u<(t.selectedMethod.min||50)){const n=document.getElementById("price-with-commission"),t=document.getElementById("discount-row"),e=document.getElementById("total-amount");return n&&(n.textContent="0 ‚ÇΩ"),t&&(t.style.display="none"),e&&(e.textContent="0 ‚ÇΩ"),p&&(p.style.display="none"),g(),null}m(!0);try{let e=u;if("KZT"===a){p&&(p.style.display="flex"),b&&(b.textContent="–†–∞—Å—á—ë—Ç...");try{const n=await l(u,"KZT","RUB"),o=n.input||n.amount||u,r=n.rate||o/u;e=Math.round(o),b&&(b.textContent=`${u} KZT = ${e} RUB (–∫—É—Ä—Å: ${r.toFixed(4)})`),t.convertedAmount=e}catch(n){return console.error("[BattlePass] Convert error:",n),b&&(b.textContent="–û—à–∏–±–∫–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏"),m(!1),null}}else p&&(p.style.display="none"),t.convertedAmount=null;const c=await async function(n,e,a="rub",c=null){t.token||await i();try{return t.currentCommission=await r("calculate_commission",{amount:parseInt(String(n)),method_name:e,currency:a.toLowerCase(),account:t.steamLogin||"",promocode:c||""}),o(`Commission: ${JSON.stringify(t.currentCommission).substring(0,50)}`),t.currentCommission}catch(n){throw o(`Commission error: ${n}`,!0),n}}(e,h,"rub",s||null),g=c.amountInRouble||e,f=c.bankComission||0,y=c.steamRate||12,x=Math.max(0,y-(d||0)),v=Math.round(g*(x/100)),w=Math.round(g+f+v),I=Math.round(g*(y/100)),E=Math.round(g+f+I),k=E-w,_=document.getElementById("price-with-commission"),L=document.getElementById("total-amount"),B=document.getElementById("discount-row"),S=document.getElementById("discount-amount");_&&(_.textContent=`${E} ‚ÇΩ`),k>0?(B&&(B.style.display="flex"),S&&(S.textContent=`- ${k} ‚ÇΩ`)):B&&(B.style.display="none"),L&&(L.textContent=`${w} ‚ÇΩ`);const N={...c,finalPrice:w,serviceCommission:v,bankCommission:f,priceWithoutDiscount:E,discountAmount:k,totalAmount:w,originalAmount:u,originalCurrency:a};return t.currentCommission=N,N}catch(n){console.error("[BattlePass] Recalculate error:",n);const t=document.getElementById("price-with-commission"),e=document.getElementById("discount-row"),o=document.getElementById("total-amount");return t&&(t.textContent="0 ‚ÇΩ"),e&&(e.style.display="none"),o&&(o.textContent="0 ‚ÇΩ"),null}finally{m(!1),g()}}({amount:n,currency:t.currency,methodName:t.selectedMethod?.name,promocode:t.promocode,promocodeDiscount:t.promocodeDiscount})},300)}function g(){const n=document.getElementById("pay-btn"),e=document.getElementById("custom-amount"),o=document.getElementById("agree-terms"),r=document.getElementById("steam-login-input"),a=parseInt(e?.value)||0,i=o?.checked||!1,c=r?.value?.trim()||"",s=function(n){const e=document.getElementById("custom-amount"),o=document.getElementById("amount-error"),r=t.selectedMethod?.min||50,a="KZT"===t.currency?75e3:15e3,i="KZT"===t.currency?"‚Ç∏":"‚ÇΩ";return n&&0!==n?n<r?(e?.classList.add("error"),o&&(o.textContent=`–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –¥–ª—è —ç—Ç–æ–≥–æ —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã: ${r} ${i}`,o.style.display="block"),!1):n>a?(e?.classList.add("error"),o&&(o.textContent=`–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞: ${a} ${i}`,o.style.display="block"),!1):(e?.classList.remove("error"),o&&(o.style.display="none"),!0):(e?.classList.remove("error"),o&&(o.style.display="none"),!1)}(a);n&&(n.disabled=!(s&&i&&c))}async function b(){const n=document.getElementById("custom-amount"),e=document.getElementById("steam-login-input"),a=parseInt(n?.value)||0,c=e?.value?.trim()||"";if(!c)return void f("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ Steam –ª–æ–≥–∏–Ω","error");if(!t.selectedMethod)return void f("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã","error");if(a<t.selectedMethod.min)return void f(`–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –¥–ª—è —ç—Ç–æ–≥–æ —Å–ø–æ—Å–æ–±–∞: ${t.selectedMethod.min} ‚ÇΩ`,"error");t.steamLogin=c;const s=document.getElementById("pay-btn"),l=s?.querySelector("span");s&&(s.disabled=!0),l&&(l.textContent="–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞...");try{f("–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞...","info");const n=t.promocodeValid?t.promocode:null,e=await async function(n,e,a,c=null){if(t.token||await i(),!t.steamLogin)throw new Error("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å Steam –ª–æ–≥–∏–Ω");o(`Creating order: ${n} ${a}, method=${e}, promo=${c}`);try{const i=await r("create_order",{amount:parseInt(String(n)),method_name:e,currency:a,account:t.steamLogin,promocode:c||""});return o(`Invoice created: ${i.paymentUrl?.substring(0,50)||"no url"}`),i}catch(n){throw o(`Create order error: ${n}`,!0),n}}(a,t.selectedMethod.name,t.currency,n);if(!e.paymentUrl)throw new Error("–ù–µ –ø–æ–ª—É—á–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ –Ω–∞ –æ–ø–ª–∞—Ç—É");f("–ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–ø–ª–∞—Ç—ã...","info"),window.location.href=e.paymentUrl}catch(n){f(n.message||"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞","error",!0),s&&(s.disabled=!1),l&&(l.textContent="–û–ø–ª–∞—Ç–∏—Ç—å")}}const h="https://t.me/BattlePassSupportBot";function f(n,t="info",e=!1){const o=document.getElementById("steam-balance-notification");o&&o.remove();const r=document.createElement("div");r.id="steam-balance-notification",r.style.cssText=`\n    position: fixed;\n    top: 20px;\n    left: 50%;\n    transform: translateX(-50%);\n    z-index: 9999999;\n    background: ${"error"===t?"var(--red-color)":"var(--blue-color)"};\n    color: var(--white-color);\n    padding: 14px 24px;\n    border-radius: 8px;\n    box-shadow: 0px 12px 16px 0px rgba(0,0,0,0.24);\n    font-family: Jost, "Segoe UI", Arial, sans-serif;\n    font-size: 14px;\n    font-weight: 600;\n    animation: slideDown 0.3s ease-out;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 8px;\n  `;const a=document.createElement("span");if(a.textContent=n,r.appendChild(a),e&&"error"===t){const n=document.createElement("a");n.href=h,n.target="_blank",n.textContent="–ù–∞–ø–∏—Å–∞—Ç—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É",n.style.cssText="\n      color: var(--white-color);\n      text-decoration: underline;\n      font-size: 13px;\n      font-weight: 600;\n      cursor: pointer;\n      opacity: 0.9;\n    ",r.appendChild(n)}document.body.appendChild(r),setTimeout(()=>{r.style.animation="slideUp 0.3s ease-in",setTimeout(()=>r.remove(),300)},e&&"error"===t?5e3:3e3)}return n.default=async function(){for(console.log("[BattlePass] Starting on:",window.location.href);!document.body;)await new Promise(n=>setTimeout(n,100));(window.location.href.includes("store.steampowered.com")||window.location.href.includes("checkout.steampowered.com")||window.location.href.includes("steamcommunity.com"))&&(async function(){if(o("init() called"),document.getElementById("steam-balance-form"))return void o("Form already exists, skipping");const n=document.createElement("style");n.textContent='\n:root {\n  --back-color: #2b323c;\n  --main-color: #334056;\n  --bg-card-color: rgb(51 64 86 / 60%);\n  --dark-color: #23282e;\n  --text-color: #cfd4da;\n  --white-color: #fff;\n  --blue-color: #0396ff;\n  --action-bg: var(--blue-color);\n  --action-text: var(--white-color);\n  --green-color: #48c432;\n  --red-color: #eb4242;\n  --grid-module: 4px;\n}\n\n.steam-balance-toggle-btn {\n  position: fixed;\n  top: 50px;\n  right: 20px;\n  z-index: 999999;\n  border-radius: 8px;\n  border: none;\n  padding: 8px 16px;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  text-decoration: none;\n  font-family: Jost, "Segoe UI", Arial, sans-serif;\n  background: var(--action-bg);\n  color: var(--action-text);\n  font-size: 14px;\n  font-weight: 600;\n  text-transform: uppercase;\n  transition: box-shadow 100ms ease-in-out;\n  will-change: box-shadow;\n}\n\n.steam-balance-toggle-btn > span {\n  display: block;\n}\n\n.steam-balance-toggle-btn:hover {\n  box-shadow: 0 0 10px var(--action-bg);\n}\n\n.steam-balance-container {\n  position: fixed;\n  top: 110px;\n  right: 20px;\n  width: 420px;\n  max-height: 85vh;\n  overflow-y: auto;\n  z-index: 999998;\n  background: var(--main-color);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 12px;\n  box-shadow: 0px 12px 16px 0px rgba(0, 0, 0, 0.24);\n  font-family: Jost, "Segoe UI", Arial, sans-serif;\n  display: flex;\n  flex-direction: column;\n}\n\n.steam-balance-container.checkout-page {\n  position: relative;\n  width: 100%;\n  max-width: 940px;\n  margin: 0 auto 20px;\n  top: 32px;\n  right: 0;\n}\n\n.form-header {\n  background: var(--dark-color);\n  padding: 16px 20px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 12px 12px 0 0;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  flex-shrink: 0;\n}\n\n.form-header h3 {\n  margin: 0;\n  color: var(--white-color);\n  font-size: 18px;\n  font-weight: 700;\n  text-transform: none;\n  letter-spacing: 0;\n}\n\n.close-btn {\n  background: transparent;\n  border: none;\n  color: var(--text-color);\n  font-size: 20px;\n  cursor: pointer;\n  padding: 4px 8px;\n  transition: color 0.2s ease;\n}\n\n.close-btn:hover {\n  color: var(--white-color);\n}\n\n.form-content {\n  padding: 20px;\n  flex: 1;\n  overflow-y: auto;\n}\n\n.steam-login-section {\n  margin-bottom: 16px;\n}\n\n.steam-login-section h4,\n.payment-methods h4,\n.amount-section h4,\n.currency-section h4,\n.promocode-section h4 {\n  color: var(--white-color);\n  font-size: 14px;\n  margin: 0 0 8px 0;\n  font-weight: 700;\n  text-transform: none;\n}\n\n.login-hint,\n.amount-hint,\n.promocode-hint {\n  display: block;\n  color: var(--text-color);\n  font-size: 12px;\n  font-weight: 500;\n  margin-top: 4px;\n}\n\n.methods-grid {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 8px;\n  margin-bottom: 16px;\n}\n\n.method-btn {\n  display: flex;\n  align-items: center;\n  background: var(--dark-color);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  color: var(--text-color);\n  padding: 8px 12px;\n  border-radius: 8px;\n  cursor: pointer;\n  font-size: 12px;\n  font-weight: normal;\n  transition: all 0.2s ease;\n  font-family: "Segoe UI", Arial, sans-serif;\n  text-align: left;\n}\n\n.method-btn:hover {\n  background: var(--main-color);\n  border-color: var(--blue-color);\n  color: var(--white-color);\n}\n\n.method-btn.active {\n  background: var(--blue-color);\n  border-color: var(--blue-color);\n  color: var(--white-color);\n}\n\n.method-text {\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  flex: 1;\n  margin-left: 8px;\n}\n\n.method-name {\n  font-size: 12px;\n}\n\n.method-commission {\n  display: block;\n  font-size: 11px;\n  color: var(--text-color);\n  margin-top: 2px;\n  font-weight: 500;\n}\n\n.method-btn.active .method-commission {\n  color: var(--white-color);\n}\n\n.currency-section {\n  margin-bottom: 16px;\n}\n\n.currency-selector {\n  display: flex;\n  gap: 8px;\n}\n\n.currency-btn {\n  flex: 1;\n  background: var(--dark-color);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  color: var(--text-color);\n  padding: 10px 16px;\n  border-radius: 8px;\n  cursor: pointer;\n  font-size: 14px;\n  font-weight: 600;\n  transition: all 0.2s ease;\n  font-family: Jost, "Segoe UI", Arial, sans-serif;\n}\n\n.currency-btn:hover {\n  background: var(--main-color);\n  color: var(--white-color);\n  border-color: var(--blue-color);\n}\n\n.currency-btn.active {\n  background: var(--blue-color);\n  border-color: var(--blue-color);\n  color: var(--white-color);\n}\n\n.amount-section {\n  margin-bottom: 12px;\n}\n\n.amount-input {\n  width: 100%;\n  padding: 8px 12px;\n  background: var(--dark-color);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  color: var(--white-color);\n  font-size: 14px;\n  font-weight: normal;\n  font-family: "Segoe UI", Arial, sans-serif;\n  margin-bottom: 8px;\n  box-sizing: border-box;\n}\n\n.amount-input:focus {\n  outline: none;\n  border-color: var(--blue-color);\n  background: var(--dark-color);\n}\n\n.amount-input.error {\n  border-color: #ff4444 !important;\n  background: rgba(255, 68, 68, 0.1);\n}\n\n.amount-input::placeholder {\n  color: var(--text-color);\n  opacity: 0.6;\n}\n\n.amount-error {\n  display: block;\n  font-size: 12px;\n  color: #ff4444;\n  margin-bottom: 4px;\n}\n\n.amount-input::-webkit-outer-spin-button,\n.amount-input::-webkit-inner-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n\n.amount-input[type="number"] {\n  -moz-appearance: textfield;\n}\n\n.quick-amounts {\n  display: grid;\n  grid-template-columns: repeat(3, 1fr);\n  gap: 6px;\n}\n\n.amount-btn {\n  background: var(--dark-color);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  color: var(--text-color);\n  padding: 6px 8px;\n  border-radius: 8px;\n  cursor: pointer;\n  font-size: 12px;\n  font-weight: normal;\n  transition: all 0.2s ease;\n  font-family: "Segoe UI", Arial, sans-serif;\n}\n\n.amount-btn:hover {\n  background: var(--main-color);\n  color: var(--white-color);\n  border-color: var(--blue-color);\n}\n\n.promocode-section {\n  margin-bottom: 16px;\n}\n\n.promocode-input-wrapper {\n  position: relative;\n  display: flex;\n  align-items: center;\n}\n\n.promocode-input-wrapper input {\n  flex: 1;\n  text-transform: uppercase;\n}\n\n.promocode-status {\n  position: absolute;\n  right: 12px;\n  font-size: 16px;\n  font-weight: bold;\n}\n\n.promocode-status.checking {\n  color: var(--text-color);\n}\n\n.promocode-status.valid {\n  color: var(--green-color);\n}\n\n.promocode-status.invalid {\n  color: var(--red-color);\n}\n\n.balance-info {\n  background: var(--dark-color);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  padding: 14px;\n  margin-bottom: 16px;\n  position: relative;\n  min-height: 80px;\n}\n\n.info-row {\n  display: flex;\n  justify-content: space-between;\n  color: var(--text-color);\n  font-size: 14px;\n  font-weight: 500;\n  margin-bottom: 8px;\n  line-height: 1.4;\n}\n\n.info-row:last-child {\n  margin-bottom: 0;\n  padding-top: 8px;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n  font-weight: 700;\n  color: var(--white-color);\n}\n\n.total-row {\n  font-weight: 700;\n  color: var(--white-color) !important;\n}\n\n.total-row span {\n  color: var(--white-color) !important;\n}\n\n.discount-row .discount-value {\n  color: var(--green-color);\n}\n\n.balance-spinner {\n  display: none;\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  background: rgba(0, 0, 0, 0.2);\n  color: #c7d5e0;\n  font-size: 13px;\n  gap: 10px;\n  z-index: 1;\n}\n\n.balance-spinner .spinner-circle {\n  width: 24px;\n  height: 24px;\n  border: 2px solid rgba(103, 193, 245, 0.2);\n  border-top-color: #67c1f5;\n  border-radius: 50%;\n  animation: spin 0.8s linear infinite;\n}\n\n@keyframes spin {\n  to { transform: rotate(360deg); }\n}\n\n.balance-content {\n  transition: opacity 0.15s ease;\n}\n\n.terms-checkbox {\n  margin-bottom: 16px;\n  padding: 12px;\n  background: var(--dark-color);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n}\n\n.terms-checkbox label {\n  display: flex;\n  align-items: flex-start;\n  color: var(--text-color);\n  font-size: 12px;\n  font-weight: 500;\n  cursor: pointer;\n  line-height: 1.5;\n}\n\n.terms-checkbox input[type="checkbox"] {\n  margin-right: 8px;\n  margin-top: 2px;\n  cursor: pointer;\n  flex-shrink: 0;\n}\n\n.terms-checkbox a {\n  color: var(--blue-color);\n  text-decoration: underline;\n}\n\n.terms-checkbox a:hover {\n  color: var(--white-color);\n}\n\n.support-link-section {\n  text-align: center;\n  margin-bottom: 12px;\n}\n\n.support-link-section small {\n  color: var(--text-color);\n  font-size: 12px;\n  font-weight: 500;\n}\n\n.support-link-section .support-link {\n  color: var(--blue-color);\n  text-decoration: underline;\n}\n\n.support-link-section .support-link:hover {\n  color: var(--white-color);\n}\n\n.pay-button {\n  width: 100%;\n  border-radius: 8px;\n  border: none;\n  padding: 8px 16px;\n  display: inline-block;\n  cursor: pointer;\n  text-decoration: none;\n  font-family: "Segoe UI", Arial, sans-serif;\n  background: var(--action-bg);\n  color: var(--action-text);\n  font-size: 15px;\n  font-weight: 500;\n  line-height: 30px;\n  text-transform: none;\n  transition: box-shadow 100ms ease-in-out;\n  will-change: box-shadow;\n}\n\n.pay-button > span {\n  display: block;\n}\n\n.pay-button:hover:not(:disabled) {\n  box-shadow: 0 0 10px var(--action-bg);\n}\n\n.pay-button:disabled {\n  background: rgba(0, 0, 0, 0.2);\n  color: #8b929a;\n  cursor: default;\n  opacity: 0.6;\n}\n\n.payment-note {\n  margin-top: 12px;\n  text-align: center;\n}\n\n.payment-note small {\n  color: #8b929a;\n  font-size: 11px;\n}\n\n.loading-methods {\n  color: #8b929a;\n  text-align: center;\n  padding: 20px;\n  font-size: 13px;\n}\n\n@keyframes fadeIn {\n  from { opacity: 0; transform: translateY(-10px); }\n  to { opacity: 1; transform: translateY(0); }\n}\n\n.steam-balance-container:not(.checkout-page) {\n  animation: fadeIn 0.2s ease-out;\n}\n\n@keyframes slideDown {\n  from { opacity: 0; transform: translate(-50%, -20px); }\n  to { opacity: 1; transform: translate(-50%, 0); }\n}\n\n@keyframes slideUp {\n  from { opacity: 1; transform: translate(-50%, 0); }\n  to { opacity: 0; transform: translate(-50%, -20px); }\n}\n\n.steam-balance-container::-webkit-scrollbar {\n  width: 8px;\n}\n\n.steam-balance-container::-webkit-scrollbar-track {\n  background: rgba(0, 0, 0, 0.2);\n}\n\n.steam-balance-container::-webkit-scrollbar-thumb {\n  background: rgba(103, 193, 245, 0.3);\n  border-radius: 4px;\n}\n\n.steam-balance-container::-webkit-scrollbar-thumb:hover {\n  background: rgba(103, 193, 245, 0.5);\n}\n\n@media (max-width: 768px) {\n  .steam-balance-container:not(.checkout-page) {\n    width: calc(100% - 40px);\n    right: 20px;\n    left: 20px;\n    top: 70px;\n  }\n\n  .steam-balance-toggle-btn {\n    right: 20px;\n    top: 10px;\n  }\n\n  .methods-grid {\n    grid-template-columns: 1fr;\n  }\n\n  .quick-amounts {\n    grid-template-columns: repeat(2, 1fr);\n  }\n}\n\nbutton:focus,\ninput:focus {\n  outline: none;\n}\n\n@media (prefers-reduced-motion: reduce) {\n  * {\n    animation: none !important;\n    transition: none !important;\n  }\n}\n\n/* Inline top-up button on game pages */\n.bp-topup-inline-btn {\n  display: inline-block;\n  vertical-align: top;\n}\n\n.bp-topup-btn {\n  margin-top: 8px;\n  background: var(--action-bg);\n  color: var(--action-text);\n  border-radius: 8px;\n  padding: 12px 16px;\n  font-weight: 600;\n  text-transform: uppercase;\n  transition: box-shadow 100ms ease-in-out;\n  border: none;\n  font-family: Jost, "Segoe UI", Arial, sans-serif;\n}\n\n.bp-topup-btn:hover {\n  box-shadow: 0 0 10px var(--action-bg);\n}\n',document.head.appendChild(n),o("Styles added"),a(),o(`Steam info: login=${t.steamLogin}, id=${t.steamId64}`);const r=document.createElement("div");if(r.innerHTML=`\n    <div id="steam-balance-form" class="steam-balance-container ${e?"checkout-page":""}">\n      <div class="form-header">\n        <h3>–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ Steam</h3>\n        ${e?"":'<button id="close-form" class="close-btn">‚úï</button>'}\n      </div>\n\n      <div class="form-content">\n        <div class="steam-login-section">\n          <h4>–í–∞—à Steam –ª–æ–≥–∏–Ω:</h4>\n          <input type="text" id="steam-login-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω Steam" class="amount-input">\n          <small class="login-hint">–õ–æ–≥–∏–Ω –æ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞ Steam (–Ω–µ email)</small>\n        </div>\n\n        <div class="payment-methods">\n          <h4>–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã:</h4>\n          <div class="methods-grid" id="methods-grid">\n            <div class="loading-methods">–ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–æ—Å–æ–±–æ–≤ –æ–ø–ª–∞—Ç—ã...</div>\n          </div>\n        </div>\n\n        <div class="currency-section">\n          <h4>–í–∞–ª—é—Ç–∞ Steam:</h4>\n          <div class="currency-selector" id="currency-selector">\n            <button class="currency-btn active" data-currency="RUB">RUB</button>\n            <button class="currency-btn" data-currency="KZT">KZT</button>\n          </div>\n        </div>\n\n        <div class="amount-section">\n          <h4>–°—É–º–º–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è (<span id="currency-label">RUB</span>):</h4>\n          <input type="number" id="custom-amount" placeholder="–û—Ç 50" min="50" class="amount-input" value="100">\n          <small class="amount-error" id="amount-error" style="display: none; color: #ff4444; margin-top: 4px;"></small>\n          <small class="amount-hint" id="amount-hint">–ú–∏–Ω–∏–º—É–º: 50 RUB. –ú–∞–∫—Å–∏–º—É–º: 15 000 RUB</small>\n\n          <div class="quick-amounts" id="quick-amounts">\n            <button class="amount-btn" data-amount="500">500</button>\n            <button class="amount-btn" data-amount="1000">1000</button>\n            <button class="amount-btn" data-amount="5000">5000</button>\n          </div>\n        </div>\n\n        <div class="promocode-section">\n          <h4>–ü—Ä–æ–º–æ–∫–æ–¥:</h4>\n          <div class="promocode-input-wrapper">\n            <input type="text" id="promocode-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥" class="amount-input" value="HELLO">\n            <span id="promocode-status" class="promocode-status"></span>\n          </div>\n          <small id="promocode-hint" class="promocode-hint">–ü—Ä–æ–º–æ–∫–æ–¥ –¥–∞—ë—Ç —Å–∫–∏–¥–∫—É –Ω–∞ –∫–æ–º–∏—Å—Å–∏—é —Å–µ—Ä–≤–∏—Å–∞</small>\n        </div>\n\n        <div class="balance-info">\n          <div class="info-row" id="convert-row" style="display: none;">\n            <span>–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è:</span>\n            <span id="convert-info">-</span>\n          </div>\n          <div class="info-row">\n            <span>–°—Ç–æ–∏–º–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–∞</span>\n            <span id="price-with-commission">0 ‚ÇΩ</span>\n          </div>\n          <div class="info-row discount-row" id="discount-row" style="display: none;">\n            <span>–°–∫–∏–¥–∫–∞</span>\n            <span id="discount-amount" class="discount-value">- 0 ‚ÇΩ</span>\n          </div>\n          <div class="info-row total-row">\n            <span>–ò—Ç–æ–≥–æ</span>\n            <span id="total-amount">0 ‚ÇΩ</span>\n          </div>\n        </div>\n\n        <div class="terms-checkbox">\n          <label>\n            <input type="checkbox" id="agree-terms">\n            <span>–Ø –æ–∑–Ω–∞–∫–æ–º–ª–µ–Ω —Å <a href="https://battlepass.ru/info/agreement" target="_blank">–°–æ–≥–ª–∞—à–µ–Ω–∏–µ–º</a> –∏ <a href="https://battlepass.ru/info/privacypolicy" target="_blank">–ü–æ–ª–∏—Ç–∏–∫–æ–π –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a></span>\n          </label>\n        </div>\n\n        <div class="support-link-section">\n          <small>–í–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã? <a href="https://t.me/BattlePassSupportBot" target="_blank" class="support-link">–ù–∞–ø–∏—Å–∞—Ç—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É</a></small>\n        </div>\n\n        <button id="pay-btn" class="pay-button" disabled>\n          <span>–û–ø–ª–∞—Ç–∏—Ç—å</span>\n        </button>\n\n        <div class="payment-note">\n          <small>üîí –ü–ª–∞—Ç–µ–∂–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –∑–∞—â–∏—â–µ–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ BattlePass</small>\n        </div>\n      </div>\n    </div>\n  `,document.body.insertBefore(r.firstElementChild,document.body.firstChild),e)try{d(await c())}catch(n){console.error("[BattlePass] Error loading methods:",n)}else{const n=function(){const n=document.createElement("button");n.id="steam-balance-toggle",n.className="steam-balance-toggle-btn";const t=document.createElement("span");return t.textContent="–ü–æ–ø–æ–ª–Ω–∏—Ç—å Steam",n.appendChild(t),n}();document.body.insertBefore(n,document.body.firstChild);const e=document.getElementById("steam-balance-form");e&&(e.style.display="none"),n.addEventListener("click",async()=>{if(o("Toggle button clicked"),!e)return;const n="none"===e.style.display;if(e.style.display=n?"block":"none",o("Form visibility: "+(n?"shown":"hidden")),n){if(0===t.paymentMethods.length){o("Loading payment methods...");try{const n=await c();o(`Loaded ${n.length} payment methods`),d(n)}catch(n){o(`Failed to load methods: ${n.message}`,!0),f("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ø–æ—Å–æ–±–æ–≤ –æ–ø–ª–∞—Ç—ã","error")}}const e=document.getElementById("custom-amount")?.value;if(e&&parseInt(e)>0&&t.paymentMethods.length>0)try{const n=document.getElementById("promocode-input");n&&n.value.trim()&&await s(n.value.trim()),p()}catch(n){console.error("[BattlePass] Error recalculating on open:",n)}}});const r=document.getElementById("close-form");r&&r.addEventListener("click",()=>{e&&(e.style.display="none");const n=document.getElementById("agree-terms");n&&(n.checked=!1)});let a=!1;document.addEventListener("mousedown",t=>{const o=t.target,r=o.closest(".bp-topup-btn")||o.closest(".bp-topup-inline-btn");a=!(!e||e.contains(o)||n.contains(o)||r)}),document.addEventListener("click",t=>{const o=t.target,r=o.closest(".bp-topup-btn")||o.closest(".bp-topup-inline-btn");if(e&&"block"===e.style.display&&a&&!e.contains(o)&&!n.contains(o)&&!r){e.style.display="none";const n=document.getElementById("agree-terms");n&&(n.checked=!1)}a=!1})}const i=document.getElementById("steam-login-input");t.steamLogin&&i&&(i.value=t.steamLogin);const m=function(){const n=document.querySelectorAll(".game_purchase_price, .discount_final_price, .price, [data-price-final]");for(const e of n){const n=e.textContent||"";if(n.includes("‚Ç∏")||n.includes("KZT")||n.match(/\d+[,\s]?\d*\s*—Ç–≥/i))return t.steamCurrency="KZT",console.log("[BattlePass] Detected Steam currency: KZT"),"KZT";if(n.includes("‚ÇΩ")||n.includes("—Ä—É–±")||n.includes("p—É–±"))return t.steamCurrency="RUB",console.log("[BattlePass] Detected Steam currency: RUB"),"RUB"}return t.steamCurrency="RUB",console.log("[BattlePass] Steam currency not detected, defaulting to RUB"),"RUB"}();t.currency=m;const u=document.getElementById("currency-selector"),h=document.getElementById("currency-label");u&&(u.querySelectorAll(".currency-btn").forEach(n=>{const e=n;e.classList.toggle("active",e.dataset.currency===t.currency)}),h&&(h.textContent=t.currency),u.querySelectorAll(".currency-btn").forEach(n=>{n.addEventListener("click",async function(){const n=this.dataset.currency||"RUB",e=t.currency;if(n===e)return;const o=document.getElementById("custom-amount"),r=parseInt(o?.value)||0;u.querySelectorAll(".currency-btn").forEach(n=>n.classList.remove("active")),this.classList.add("active"),t.currency=n,h&&(h.textContent=n);const a="KZT"===n?250:50,i="KZT"===n?75e3:15e3;o&&(o.placeholder=`–û—Ç ${a}`);const c=document.getElementById("amount-hint");if(c&&(c.textContent=`–ú–∏–Ω–∏–º—É–º: ${a.toLocaleString()} ${n}. –ú–∞–∫—Å–∏–º—É–º: ${i.toLocaleString()} ${n}`),r>0)try{const t=await l(r,e,n),a=Math.ceil(t.input||t.amount||r);o&&(o.value=String(a)),p()}catch(n){console.error("[BattlePass] Convert on currency change error:",n),p()}})}));let y=null;function x(n){const e=(n||"").trim();t.steamLogin=e,g(),y&&clearTimeout(y),y=window.setTimeout(async()=>{const n=document.getElementById("custom-amount")?.value;if(n&&parseInt(n)>0)try{const n=document.getElementById("promocode-input");n&&n.value.trim()&&await s(n.value.trim()),p()}catch(n){console.error("[BattlePass] Error recalculating on login change:",n)}},500)}i&&(i.addEventListener("input",function(){x(this.value)}),i.addEventListener("change",function(){x(this.value)}),i.addEventListener("blur",function(){x(this.value)})),document.querySelectorAll(".amount-btn").forEach(n=>{n.addEventListener("click",function(){const n=this.dataset.amount||"100",t=document.getElementById("custom-amount");t&&(t.value=n),p()})});const v=document.getElementById("custom-amount");if(v){const n=()=>p();v.addEventListener("input",n),v.addEventListener("change",n),v.addEventListener("blur",n)}const w=document.getElementById("promocode-input");let I=null;async function E(){const n=w?.value?.trim().toUpperCase()||"",e=document.getElementById("promocode-status"),o=document.getElementById("promocode-hint");if(t.promocode=n,!n)return t.promocodeDiscount=0,t.promocodeValid=!1,e&&(e.textContent="",e.className="promocode-status"),o&&(o.textContent="–ü—Ä–æ–º–æ–∫–æ–¥ –¥–∞—ë—Ç —Å–∫–∏–¥–∫—É –Ω–∞ –∫–æ–º–∏—Å—Å–∏—é —Å–µ—Ä–≤–∏—Å–∞"),void p();e&&(e.textContent="...",e.className="promocode-status checking");const r=await s(n);r.valid&&r.discount>0?(e&&(e.textContent="‚úì",e.className="promocode-status valid"),o&&(o.textContent=`–°–∫–∏–¥–∫–∞ ${r.discount}% –Ω–∞ –∫–æ–º–∏—Å—Å–∏—é —Å–µ—Ä–≤–∏—Å–∞`)):(e&&(e.textContent="‚úó",e.className="promocode-status invalid"),o&&(o.textContent="–ü—Ä–æ–º–æ–∫–æ–¥ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω")),p()}function k(){I&&clearTimeout(I),I=window.setTimeout(E,500)}w&&(w.addEventListener("input",k),w.addEventListener("change",k),w.addEventListener("blur",k)),setTimeout(E,1e3);const _=document.getElementById("agree-terms");_&&_.addEventListener("change",g);const L=document.getElementById("pay-btn");L&&L.addEventListener("click",b),v&&v.addEventListener("keypress",function(n){if("Enter"===n.key){n.preventDefault();const t=document.getElementById("pay-btn");t&&!t.disabled&&t.click()}}),console.log("[BattlePass] UI initialized")}(),console.log("[BattlePass] UI created"))},Object.defineProperty(n,"__esModule",{value:!0}),n}({})};function ExecutePluginModule(){let n=window.MILLENNIUM_PLUGIN_SETTINGS_STORE[pluginName];n.OnPluginConfigChange=function(t,e,o){t in n.settingsStore&&(n.ignoreProxyFlag=!0,n.settingsStore[t]=o,n.ignoreProxyFlag=!1)},MILLENNIUM_BACKEND_IPC.postMessage(0,{pluginName:pluginName,methodName:"__builtins__.__millennium_plugin_settings_parser__"}).then(async t=>{"string"==typeof t.returnValue&&(n.ignoreProxyFlag=!0,n.settingsStore=n.DefinePluginSetting(Object.fromEntries(JSON.parse(atob(t.returnValue)).map(n=>[n.functionName,n]))),n.ignoreProxyFlag=!1);let e=PluginEntryPointMain();Object.assign(window.PLUGIN_LIST[pluginName],{...e,__millennium_internal_plugin_name_do_not_use_or_change__:pluginName});let o=await e.default();var r;o&&(r=o)&&void 0!==r.title&&void 0!==r.icon&&void 0!==r.content?window.MILLENNIUM_SIDEBAR_NAVIGATION_PANELS[pluginName]=o:console.warn(`Plugin ${pluginName} does not contain proper SidebarNavigation props and therefor can't be mounted by Millennium. Please ensure it has a title, icon, and content.`)})}ExecutePluginModule();